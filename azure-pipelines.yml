# C/C++ with GCC
# Build your C/C++ project with GCC using make.
# Add steps that publish test results, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/apps/c-cpp/gcc

pool:
  vmImage: 'vs2017-win2016'

steps:
- powershell: |
    Write-Host "Downloading Qt installer..."
    Invoke-WebRequest -Uri "https://download.qt.io/archive/online_installers/3.0/qt-unified-windows-x86-3.0.5-online.exe" -OutFile "qtinstall.exe"
    Write-Host "Installing Qt..."
    & $(Join-Path -Path $pwd -ChildPath "qtinstall.exe") --verbose --script qt-installer-script.js
    Get-ChildItem -Path C:\Qt
    dir
    mkdir build
    cd build
    Write-Host "Running cmake..."
    cmake .. -G "Visual Studio 15 2017 Win64"
    cmake --build . --config Release 
  displayName: 'Build'
